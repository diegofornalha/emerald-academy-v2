---
layout: examples
---

# üíé Emerald Academy
## **üö© Desafio 4: Vota√ß√£o**

üé´ Implemente um contrato de vota√ß√£o para aprender o b√°sico de vota√ß√£o dentro de uma DAO no blockchain Flow e Cadence. Voc√™ usar√°:

- O emulador Flow local para implantar contratos inteligentes.
- A carteira Flow local de desenvolvimento para fazer login nas contas de teste.
- Um aplicativo modelo Next.js com scripts e transa√ß√µes de amostra para interagir com seu contrato.

üåü O resultado final √© um DApp que cria uma DAO aberta que permite que os membros da comunidade criem propostas e votem nelas com base nas participa√ß√µes em tokens que governam a DAO.

üí¨ Conhe√ßa outros construtores trabalhando neste desafio e obtenha ajuda no **[Discord Emerald City](https://discord.gg/emerald-city-906264258189332541)**!

---

# **üì¶ Checkpoint 0: Instalar**

Necess√°rio:

- **[Git](https://git-scm.com/downloads)**
- **[Node](https://nodejs.org/dist/latest-v16.x/)** (üß® Use o Node v16 ou uma vers√£o anterior, pois a v17 pode causar erros üß®). Voc√™ sabe que o instalou se digitar **`node -v`** no terminal e imprimir uma vers√£o.
- **[Flow CLI](https://docs.onflow.org/flow-cli/install/)** (üß® Certifique-se de instalar o link correto para seu sistema üß®). Voc√™ sabe que o instalou se digitar **`flow version`** no terminal e imprimir uma vers√£o.

```sh
git clone https://github.com/emerald-dao/4-voting.git

```

> em uma janela do terminal, üì± instale as depend√™ncias e inicie o frontend:
> 

```sh
cd 4-voting
npm install
npm run dev
```

> em uma segunda janela do terminal, inicie seu üë∑‚Äç emulador local:
> 

```bash
cd 4-voting
flow emulator start -v
```

*Nota: a flag **`-v`** significa imprimir a sa√≠da de transa√ß√£o e script no seu emulador local*

> em uma terceira janela do terminal, üíæ implante seu contrato e üí∏ inicie sua carteira local:
> 

```bash
cd 4-voting
flow project deploy
flow dev-wallet
```

> Voc√™ pode usar flow project deploy --update para implantar um novo contrato a qualquer momento.
> 

üì± Abra **[http://localhost:3000](http://localhost:3000/)** para ver o aplicativo

---

# **üëõ Checkpoint 1: Carteiras**

Usaremos **a carteira Flow local de desenvolvimento**.

> Clique no bot√£o "Log In" e observe que uma janela aparece com diferentes contas para selecionar, cada uma com seu pr√≥prio saldo de Flow Token. Selecione a primeira conta para fazer login nela.
> 

---

# **üîñ Checkpoint 2: Nomear e descrever sua DAO**

Depois de fazer login no nosso DApp, voc√™ ver√° que n√£o h√° nome nem descri√ß√£o para a nossa DAO:

<img src="https://i.imgur.com/YxDuWN5.png" alt="empty" width="400" />

> Abra ./pages/index.js e role para baixo at√© ver "Example DAO" e "Replace this with a description of your DAO". Substitua essas linhas por um nome e descri√ß√£o da sua DAO.
> 

Agora voc√™ ver√° que isso foi alterado na interface:

<img src="https://i.imgur.com/nRHh0Mr.png" alt="nome e descri√ß√£o do dao" width="400" />

---

# **üë™ Checkpoint 3: Participar do DAO**

Agora que demos um nome e descri√ß√£o ao nosso DAO, vamos participar do DAO!

> Clique no bot√£o "Join this DAO" e voc√™ ver√° um modelo de transa√ß√£o aparecer:
> 

<img src="https://i.imgur.com/pvRoZPb.png" alt="participar do dao tx" width="400" />

Se voc√™ clicar em "Approve", ter√° acesso ao painel principal do DAO.

Por tr√°s dos bastidores, voc√™ acabou de configurar seu pr√≥prio cofre de tokens para o token que governa este DAO.

> Para ver o contrato inteligente deste token, v√° para ./flow/cadence/ExampleToken.cdc
> 

> Para ver como essa transa√ß√£o foi executada, confira a fun√ß√£o joinDAO dentro de ./pages/index.js
> 

---

# **üìë Checkpoint 4: Criar uma Proposta**

Depois de entrar no DAO, voc√™ ser√° levado ao painel principal do seu DAO. Voc√™ pode ver que n√£o h√° propostas ativas, ent√£o vamos criar uma!

> Pressione o bot√£o "Submit Proposal" no lado direito
> 

Para criar uma proposta, voc√™ deve preencher:

- O nome da proposta
- A imagem da proposta
- Uma data de in√≠cio e fim
- Uma descri√ß√£o da proposta

<img src="https://i.imgur.com/HMfsBPQ.png" alt="preenchendo campos da proposta" width="400" />

> Clique em "Submit Proposal" para executar uma transa√ß√£o que criar√° a nova proposta on-chain
> 

<img src="https://i.imgur.com/Fg8Qmuz.png" alt="executar proposta de envio tx" width="400" />

Um popup aparecer√° para criar sua nova proposta. Esta √© uma transa√ß√£o que alterar√° os dados na blockchain. Especificamente, est√° criando um novo recurso **`Proposal`** e armazenando-o na cole√ß√£o de propostas do seu DAO.

> Para ver como essa transa√ß√£o foi executada, confira a fun√ß√£o submitProposal dentro de ./pages/submit.js
> 

> Para saber mais sobre Cadence e Resources, voc√™ pode consultar o c√≥digo do contrato em ./flow/cadence/Vote.cdc ou verificar nosso <a href="https://github.com/emerald-dao/beginner-cadence-course">Curso Iniciante de Cadence</a>
> 

Depois de clicar em "Approve", voc√™ ser√° levado de volta ao painel principal. Agora voc√™ deve ver uma vota√ß√£o em andamento:

<img src="https://i.imgur.com/PQXUtbb.png" alt="uma vota√ß√£o est√° em andamento" width="400" />

---

# **üëÄ Checkpoint 5: Visualizando uma Proposta**

Agora que uma proposta foi criada, vamos clicar nela e ver como ela √©:

<img src="https://i.imgur.com/R78d772.png" alt="proposta ativa" width="400" />

Voc√™ deve ver:

- Nome
- Descri√ß√£o
- Imagem
- Contagem de votos
- Quem votou em qual op√ß√£o
- Data de in√≠cio e fim
- Quem enviou a proposta

No entanto, para realmente votar, devemos possuir alguns tokens dentro do DAO!

---

# **üí∏ Checkpoint 6: Obtendo Tokens**

Para obter alguns tokens, vamos criar alguns para a nossa conta.

> Em uma nova janela do terminal, execute npm run mint 0xf8d6e0586b0a20c7 30.0
> 

Isso criar√° 30.0 tokens para a conta com endere√ßo 0xf8d6e0586b0a20c7.

Se voc√™ voltar ao aplicativo e atualizar a p√°gina (certificando-se de estar conectado com a conta 0xf8d6e0586b0a20c7), voc√™ notar√° a atualiza√ß√£o do saldo no topo:

<img src="https://i.imgur.com/zH4fgxP.png" alt="atualiza√ß√£o do saldo" width="400" />

> Para ver como esse comando criou tokens em nossa conta, verifique ./actions/mint_tokens.js
> 

---

# **üì§ Checkpoint 7: Votando**

Voc√™ pode clicar para votar de uma determinada maneira, clicando em "For", "Against" ou "Abstain".

> Clique em uma das op√ß√µes de voto e veja o popup da transa√ß√£o aparecer:
> 

<img src="https://i.imgur.com/AOjf5wx.png" alt="tx para votar" width="400" />

Se voc√™ clicar em aprovar, deve ver a contagem de votos mudar e seu endere√ßo ser adicionado √† lista de eleitores abaixo. Lembre-se de que voc√™ n√£o pode votar novamente!

---

# **üìò Checkpoint 8: Votar com uma Conta Diferente**

Vamos tentar enviar um voto de outra conta!

1. No topo, clique em "Logout" e fa√ßa login com uma conta diferente da anterior.
2. Junte-se ao DAO
3. Crie tokens para a nova conta usando o mesmo comando do Checkpoint 6, certificando-se de alterar o endere√ßo para a nova conta.
4. Clique na mesma proposta e vote novamente.
5. Observe a contagem de votos mudar!

---

# **üíæ Checkpoint 9: Implant√°-lo no testnet!**

üìî Pronto para implantar em um testnet p√∫blico?!?

> üîê Gere um endere√ßo de implantador digitando flow keys generate --network=testnet em um terminal. Certifique-se de salvar sua chave p√∫blica e chave privada em algum lugar, voc√™ precisar√° delas em breve.
> 

<img src="https://i.imgur.com/jU9sRiL.png" alt="gerar par de chaves" />

> üëõ Crie sua conta de implantador acessando https://testnet-faucet.onflow.org/, colando sua chave p√∫blica acima e clicando em CREATE ACCOUNT:
> 

<img src="https://i.imgur.com/OitvEoO.png" alt="configurar conta de teste no site" width="400" />

> Depois de terminar, clique em COPY ADDRESS e certifique-se de salvar esse endere√ßo em algum lugar. Voc√™ precisar√° dele!
> 

> ‚õΩÔ∏è Adicione sua nova conta de teste ao seu flow.json modificando as seguintes linhas de c√≥digo. Cole seu endere√ßo que voc√™ copiou acima onde diz "YOUR GENERATED ADDRESS" e cole sua chave privada onde diz "YOUR PRIVATE KEY".
> 

```json
"accounts": {
  "emulator-account": {
    "address": "f8d6e0586b0a20c7",
    "key": "5112883de06b9576af62b9aafa7ead685fb7fb46c495039b1a83649d61bff97c"
  },
  "testnet-account": {
    "address": "YOUR GENERATED ADDRESS",
    "key": {
      "type": "hex",
      "index": 0,
      "signatureAlgorithm": "ECDSA_P256",
      "hashAlgorithm": "SHA3_256",
      "privateKey": "YOUR PRIVATE KEY"
    }
  }
},
"deployments": {
  "emulator": {
    "emulator-account": [
      "ExampleToken",
      "Vote"
    ]
  },
  "testnet": {
    "testnet-account": [
      "ExampleToken",
      "Vote"
    ]
  }
}
```

> üöÄ Implante seu contrato inteligente Vote:
> 

```sh
flow project deploy --network=testnet
```

<img src="https://i.imgur.com/nsASuV3.png" alt="implantar contrato no testnet" />

> Por √∫ltimo, configure seu arquivo .env para apontar para o Flow TestNet para que possamos interagir com seu novo contrato.
> 

No seu arquivo .env, altere o seguinte:

1. **`NEXT_PUBLIC_CONTRACT_ADDRESS`** para o seu endere√ßo testnet gerado
2. **`NEXT_PUBLIC_STANDARD_ADDRESS`** para **`0x9a0766d93b6608b7`**
3. **`PRIVATE_KEY`** para sua chave privada
4. **`NEXT_PUBLIC_ACCESS_NODE`** para **`https://rest-testnet.onflow.org`**
5. **`NEXT_PUBLIC_WALLET`** para **`https://fcl-discovery.onflow.org/testnet/authn`**

Agora voc√™ pode encerrar todos os seus terminais, pois n√£o precisamos mais executar nossa pr√≥pria blockchain ou carteira local. Tudo est√° no testnet!

Vamos testar nosso aplicativo no testnet:

1. Execute **`npm run dev`** para iniciar seu aplicativo em um terminal.
2. Em **[http://localhost:3000/](http://localhost:3000/)**, clique em "connect" e fa√ßa login na sua carteira Blocto ou Lilico, certificando-se de copiar o endere√ßo com o qual voc√™ faz login.
3. Junte-se ao DAO e execute a transa√ß√£o. Aguarde cerca de 30 segundos e, em seguida, atualize a p√°gina. Voc√™ deve estar no DAO agora.
4. Crie uma nova proposta, como antes.
5. Para obter tokens, execute **`npm run mint [THE ADDRESS YOU COPIED IN STEP 2] [AMOUNT OF TOKENS]`** como fizemos no Checkpoint 6.
6. No seu terminal, voc√™ deve ver um "Transaction Id" impresso. Se voc√™ acessar o **[Testnet Flowdiver](https://testnet.flowdiver.io)** e colar esse Transaction Id, voc√™ dever√° ver informa√ß√µes sobre a transa√ß√£o de cria√ß√£o de tokens.
7. Tente votar na sua proposta.

---

# **üìù Fa√ßa edi√ß√µes!**

üîè Voc√™ tamb√©m pode verificar seu contrato inteligente de token **`ExampleToken.cdc`** em **`flow/cadence/ExampleToken.cdc`** ou seu contrato inteligente de vota√ß√£o/DAO **`Vote.cdc`** em **`flow/cadence/Vote.cdc`**

üíº D√™ uma olhada r√°pida em como seu contrato √© implantado em **`flow.json`**.

üìù Se voc√™ quiser fazer edi√ß√µes no frontend, abra **`index.js`** em **`pages/index.js`**.

# **‚öîÔ∏è Miss√µes secund√°rias**

> üèÉ V√° para o pr√≥ximo desafio aqui.
> 

> üí¨ Conhe√ßa outros desenvolvedores trabalhando neste desafio e obtenha ajuda no [üíéDiscord da Emerald City](https://discord.gg/emerald-city-906264258189332541)!
> 

> üëâ Problemas, perguntas, coment√°rios sobre a pilha? Poste-os no [üíéDiscord da Emerald City](https://discord.gg/emerald-city-906264258189332541)!
>